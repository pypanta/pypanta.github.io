import{_ as x,r as p,s as E,C as S,c as i,p as d,a as s,t as l,F as A,D,z as y,B as f,o as r,d as a,A as j,v as I,x as M}from"./B-YT2MGI.js";import{u as T}from"./B1ewgIlZ.js";import{f as F,a as N}from"./0v-QSy9O.js";const U={class:"dashboard-container"},V={key:0,class:"dashboard-contacts"},B={class:"contact-detail__btns"},P=["onClick"],L=["onClick"],R={key:1,class:"dashboard-comments"},z=["onSubmit"],q={class:"dashboard-comments__edit-comment-form__btns"},G={key:1},H={key:0,class:"comment-detail__btns"},J=["onClick"],K=["onClick"],O={__name:"dashboard",emits:["formActions"],setup(Q,{emit:W}){const m=T(),c=p(null),v=p(null),u=E({commentId:null,body:null}),_=p(!1);async function h(){const n=await f("contacts");n.ok?c.value=await n.json():console.log(n)}async function $(){const n=await f("/");if(n.ok){let o=function(g){for(const b of g)t.push(b),b.replies.length&&o(b.replies)};const e=await n.json();let t=[];e.length&&o(e),v.value=t}else console.log(n)}S(()=>{h(),$()});const k=async(n,e)=>{let t;if(e==="read")t=`read-contact/${n}`;else if(e==="delete")t=`delete-contact/${n}`;else return;const o=await f(t);if(o.ok||o.status===404){const g=await o.json();o.ok?(c.value=c.value.filter(b=>b.id!==n),m.showAlert(5e3,g.message,"message-success")):m.showAlert(5e3,g.message,"message-danger")}else console.log(o)},C=(n=null,e=null)=>{_.value=!_.value,_.value&&n&&e?(u.commentId=n,u.body=e):(u.commentId=null,u.body=null)},w=async(n,e)=>{if(e==="edit"){const t=await f(`${n}/update`,"PUT",{body:u.body});if(t.ok)F(v.value,n,o=>o.body=u.body),C(),m.showAlert(5e3,"Comment is successfully updated","message-success");else{const o=await t.json();m.showAlert(5e3,o.message,"message-danger")}}else e==="delete"&&((await f(`${n}/delete`,"DELETE")).ok?(N(v.value,n),m.showAlert(5e3,"Comment is successfully deleted","message-success")):m.showAlert(5e3,"There is a problem to delete a comment","message-danger"))};return(n,e)=>(r(),i("div",U,[d(c)?(r(),i("div",V,[s("h2",null,"Contacts "+l(d(c).length),1),(r(!0),i(A,null,D(d(c),t=>(r(),i("div",{key:t.id,class:"contact-detail"},[s("div",null,[e[2]||(e[2]=s("strong",null,"ID",-1)),a(": "+l(t.id),1)]),s("div",null,[e[3]||(e[3]=s("strong",null,"Subject:",-1)),a(" "+l(t.subject),1)]),s("div",null,[e[4]||(e[4]=s("strong",null,"Name:",-1)),a(" "+l(t.name),1)]),s("div",null,[e[5]||(e[5]=s("strong",null,"E-mail:",-1)),a(" "+l(t.email),1)]),s("div",null,[e[6]||(e[6]=s("strong",null,"Created at:",-1)),a(" "+l(t.created_at),1)]),s("div",null,[e[7]||(e[7]=s("strong",null,"Message:",-1)),a(" "+l(t.message),1)]),s("div",B,[s("button",{onClick:o=>k(t.id,"read"),class:"contact-detail__btns-read"}," Mark as read ",8,P),s("button",{onClick:o=>k(t.id,"delete"),class:"contact-detail__btns-delete"}," Delete ",8,L)])]))),128))])):y("",!0),d(v)?(r(),i("div",R,[s("h2",null,"Comments "+l(d(v).length),1),(r(!0),i(A,null,D(d(v),t=>(r(),i("div",{key:t.id,class:"comment-detail"},[s("div",null,[e[8]||(e[8]=s("strong",null,"ID",-1)),a(": "+l(t.id),1)]),s("div",null,[e[9]||(e[9]=s("strong",null,"Post ID",-1)),a(": "+l(t.post_id),1)]),s("div",null,[e[10]||(e[10]=s("strong",null,"Parent ID",-1)),a(": "+l(t.parent_id),1)]),s("div",null,[e[11]||(e[11]=s("strong",null,"User ID",-1)),a(": "+l(t.user_id),1)]),s("div",null,[e[12]||(e[12]=s("strong",null,"Created at",-1)),a(": "+l(t.created_at),1)]),s("div",null,[d(_)&&d(u).commentId===t.id?(r(),i("form",{key:0,onSubmit:j(o=>w(t.id,"edit"),["prevent"]),class:"dashboard-comments__edit-comment-form"},[I(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>d(u).body=o),rows:"5"},null,512),[[M,d(u).body]]),s("div",q,[e[13]||(e[13]=s("button",{class:"dashboard-comments__edit-comment-form__btns__submit"}," Submit ",-1)),s("button",{onClick:e[1]||(e[1]=o=>_.value=!1),type:"button",class:"dashboard-comments__edit-comment-form__btns__cancel"}," Cancel ")])],40,z)):(r(),i("div",G,[e[14]||(e[14]=s("strong",null,"Text",-1)),a(": "+l(t.body),1)]))]),d(_)?y("",!0):(r(),i("div",H,[s("button",{onClick:o=>C(t.id,t.body),class:"comment-detail__btns-edit"}," Edit ",8,J),s("button",{onClick:o=>w(t.id,"delete"),class:"comment-detail__btns-delete"}," Delete ",8,K)]))]))),128))])):y("",!0)]))}},ee=x(O,[["__scopeId","data-v-d07627ff"]]);export{ee as default};
